<% if collection && collection.respond_to?(:total_pages) && collection.total_pages > 1 %>
  <nav class="flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6" aria-label="Pagination">
    <div class="hidden sm:block">
      <p class="text-sm text-gray-700">
        <%= page_entries_info(collection) %>
      </p>
    </div>
    
    <div class="flex justify-between flex-1 sm:justify-end">
      <% if collection.prev_page %>
        <%= link_to url_for(params.permit!.merge(param_name => collection.prev_page)), 
            class: "relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50" do %>
          Previous
        <% end %>
      <% else %>
        <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-400 bg-white border border-gray-300 rounded-md cursor-not-allowed">
          Previous
        </span>
      <% end %>
      
      <div class="hidden md:flex items-center mx-4">
        <% if collection.first_page? %>
          <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 cursor-not-allowed">
            1
          </span>
        <% else %>
          <%= link_to "1", url_for(params.permit!.merge(param_name => 1)), 
              class: "relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50" %>
        <% end %>
        
        <% if collection.current_page > window + 2 %>
          <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300">
            ...
          </span>
        <% end %>
        
        <% ((collection.current_page - window)..(collection.current_page + window)).each do |page| %>
          <% if page > 1 && page < collection.total_pages %>
            <% if page == collection.current_page %>
              <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-indigo-600">
                <%= page %>
              </span>
            <% else %>
              <%= link_to page, url_for(params.permit!.merge(param_name => page)), 
                  class: "relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50" %>
            <% end %>
          <% end %>
        <% end %>
        
        <% if collection.current_page < collection.total_pages - window - 1 %>
          <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300">
            ...
          </span>
        <% end %>
        
        <% if collection.last_page? %>
          <span class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-indigo-600">
            <%= collection.total_pages %>
          </span>
        <% elsif collection.total_pages > 1 %>
          <%= link_to collection.total_pages, url_for(params.permit!.merge(param_name => collection.total_pages)), 
              class: "relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50" %>
        <% end %>
      </div>
      
      <% if collection.next_page %>
        <%= link_to url_for(params.permit!.merge(param_name => collection.next_page)), 
            class: "relative inline-flex items-center px-4 py-2 ml-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50" do %>
          Next
        <% end %>
      <% else %>
        <span class="relative inline-flex items-center px-4 py-2 ml-3 text-sm font-medium text-gray-400 bg-white border border-gray-300 rounded-md cursor-not-allowed">
          Next
        </span>
      <% end %>
    </div>
  </nav>
<% end %>